<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qiein.erp.pk.web.dao.ShootScheduleDao" >



    <resultMap id="BaseResultMap" type="com.qiein.erp.pk.web.entity.po.ShootSchedulePO" >
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="shoot_id" property="shootId" jdbcType="INTEGER" />
        <result column="scene_id" property="sceneId" jdbcType="INTEGER" />
        <result column="start_time" property="startTime" jdbcType="INTEGER" />
        <result column="end_time" property="endTime" jdbcType="INTEGER" />
        <result column="end_time" property="endTime" jdbcType="INTEGER" />
        <result column="status_id" property="statusId" jdbcType="VARCHAR" />
    </resultMap>

    <resultMap id="shootSchedule" type="com.qiein.erp.pk.web.entity.po.ShootSchedulePO">
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="shoot_id" property="shootId" jdbcType="INTEGER" />
        <result column="scene_id" property="sceneId" jdbcType="INTEGER" />
        <result column="start_time" property="startTime" jdbcType="INTEGER" />
        <result column="end_time" property="endTime" jdbcType="INTEGER" />
        <result column="end_time" property="endTime" jdbcType="INTEGER" />
        <result column="status_id" property="statusId" jdbcType="VARCHAR" />
        <association property="staffVO" javaType="com.qiein.erp.pk.web.entity.vo.StaffVO">
            <id property="id" column="staff_id" jdbcType="INTEGER"></id>
            <result property="nickName" column="" jdbcType="VARCHAR"></result>
        </association>

    </resultMap>

    <select id="selectScheduleByDateTime" parameterType="map" resultMap="BaseResultMap">
    select id,shoot_id,scene_id,start_time,end_time,status_id,staff.ID,staff.NICKNAME
      from hm_erp_shoot_schedule shoot
      inner join hm_erp_order_scene_schedule scene_link on shoot.id = scene_link.shoot_schedule_id
      inner join hm_erp_order_shoot_schedule shoot_link on shoot_link.order_id = scene_link.order_id
      and shoot_link.company_id = scene_link.company_id 
      inner join hm_erp_staff_schedule staff_schedule on staff_schedule.id = shoot_link.shoot_schedule_id
      inner join hm_pub_staff staff on staff.ID = staff_schedule.staff_id
      where start_time = 1;
    </select>
</mapper>